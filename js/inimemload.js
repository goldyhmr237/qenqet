(function(){var m,e,A,J,C,r,F,u=[].slice,x={}.hasOwnProperty,E=function(d,b){function y(){this.constructor=d}for(var n in b)x.call(b,n)&&(d[n]=b[n]);y.prototype=b.prototype;d.prototype=new y;d.__super__=b.prototype;return d};r=function(){};e=function(){function d(){}d.prototype.addEventListener=d.prototype.on;d.prototype.on=function(b,d){this._callbacks=this._callbacks||{};this._callbacks[b]||(this._callbacks[b]=[]);this._callbacks[b].push(d);return this};d.prototype.emit=function(){var b,d,n,a,c;
d=arguments[0];b=2<=arguments.length?u.call(arguments,1):[];this._callbacks=this._callbacks||{};if(n=this._callbacks[d])for(a=0,c=n.length;a<c;a++)d=n[a],d.apply(this,b);return this};d.prototype.removeListener=d.prototype.off;d.prototype.removeAllListeners=d.prototype.off;d.prototype.removeEventListener=d.prototype.off;d.prototype.off=function(b,d){var n,a,c,f,k;if(!this._callbacks||0===arguments.length)return this._callbacks={},this;a=this._callbacks[b];if(!a)return this;if(1===arguments.length)return delete this._callbacks[b],
this;c=f=0;for(k=a.length;f<k;c=++f)if(n=a[c],n===d){a.splice(c,1);break}return this};return d}();m=function(d){function b(a,c){var f,k,g;this.element=a;this.version=b.version;this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,"");this.clickableElements=[];this.listeners=[];this.files=[];"string"===typeof this.element&&(this.element=document.querySelector(this.element));if(!this.element||null==this.element.nodeType)throw Error("Invalid dropzone element.");if(this.element.dropzone)throw Error("Dropzone already attached.");
b.instances.push(this);this.element.dropzone=this;f=null!=(g=b.optionsForElement(this.element))?g:{};this.options=y({},this.defaultOptions,f,null!=c?c:{});if(this.options.forceFallback||!b.isBrowserSupported())return this.options.fallback.call(this);null==this.options.url&&(this.options.url=this.element.getAttribute("action"));if(!this.options.url)throw Error("No URL provided.");if(this.options.acceptedFiles&&this.options.acceptedMimeTypes)throw Error("You can't provide both 'acceptedFiles' and 'acceptedMimeTypes'. 'acceptedMimeTypes' is deprecated.");
this.options.acceptedMimeTypes&&(this.options.acceptedFiles=this.options.acceptedMimeTypes,delete this.options.acceptedMimeTypes);this.options.method=this.options.method.toUpperCase();(k=this.getExistingFallback())&&k.parentNode&&k.parentNode.removeChild(k);!1!==this.options.previewsContainer&&(this.previewsContainer=this.options.previewsContainer?b.getElement(this.options.previewsContainer,"previewsContainer"):this.element);this.options.clickable&&(this.clickableElements=!0===this.options.clickable?
[this.element]:b.getElements(this.options.clickable,"clickable"));this.init()}var y,n;E(b,d);b.prototype.Emitter=e;b.prototype.events="drop dragstart dragend dragenter dragover dragleave addedfile removedfile thumbnail error errormultiple processing processingmultiple uploadprogress totaluploadprogress sending sendingmultiple success successmultiple canceled canceledmultiple complete completemultiple reset maxfilesexceeded maxfilesreached queuecomplete".split(" ");b.prototype.defaultOptions={url:null,
method:"post",withCredentials:!1,parallelUploads:2,uploadMultiple:!1,maxFilesize:256,paramName:"file",createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120,filesizeBase:1E3,maxFiles:null,filesizeBase:1E3,params:{},clickable:!0,ignoreHiddenFiles:!0,acceptedFiles:null,acceptedMimeTypes:null,autoProcessQueue:!0,autoQueue:!0,addRemoveLinks:!1,previewsContainer:null,capture:null,dictDefaultMessage:"",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",
dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictCancelUpload:"Cancel upload",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",
accept:function(a,c){return c()},init:function(){return r},forceFallback:!1,fallback:function(){var a,c,f,k,g;this.element.className=""+this.element.className+" dz-browser-not-supported";g=this.element.getElementsByTagName("div");f=0;for(k=g.length;f<k;f++)a=g[f],/(^| )dz-message($| )/.test(a.className)&&(c=a,a.className="dz-message");c||(c=b.createElement('<div class="dz-message"><span></span></div>'),this.element.appendChild(c));if(a=c.getElementsByTagName("span")[0])a.textContent=this.options.dictFallbackMessage;
return this.element.appendChild(this.getFallbackForm())},resize:function(a){var c,f,k;c={srcX:0,srcY:0,srcWidth:a.width,srcHeight:a.height};f=a.width/a.height;c.optWidth=this.options.thumbnailWidth;c.optHeight=this.options.thumbnailHeight;null==c.optWidth&&null==c.optHeight?(c.optWidth=c.srcWidth,c.optHeight=c.srcHeight):null==c.optWidth?c.optWidth=f*c.optHeight:null==c.optHeight&&(c.optHeight=1/f*c.optWidth);k=c.optWidth/c.optHeight;a.height<c.optHeight||a.width<c.optWidth?(c.trgHeight=c.srcHeight,
c.trgWidth=c.srcWidth):f>k?(c.srcHeight=a.height,c.srcWidth=c.srcHeight*k):(c.srcWidth=a.width,c.srcHeight=c.srcWidth/k);c.srcX=(a.width-c.srcWidth)/2;c.srcY=(a.height-c.srcHeight)/2;return c},drop:function(a){return this.element.classList.remove("dz-drag-hover")},dragstart:r,dragend:function(a){return this.element.classList.remove("dz-drag-hover")},dragenter:function(a){return this.element.classList.add("dz-drag-hover")},dragover:function(a){return this.element.classList.add("dz-drag-hover")},dragleave:function(a){return this.element.classList.remove("dz-drag-hover")},
paste:r,reset:function(){return this.element.classList.remove("dz-started")},addedfile:function(a){var c,f,k,g,l,d;this.element===this.previewsContainer&&this.element.classList.add("dz-started");if(this.previewsContainer){a.previewElement=b.createElement(this.options.previewTemplate.trim());a.previewTemplate=a.previewElement;this.previewsContainer.appendChild(a.previewElement);g=a.previewElement.querySelectorAll("[data-dz-name]");f=0;for(k=g.length;f<k;f++)c=g[f],c.textContent=a.name;g=a.previewElement.querySelectorAll("[data-dz-size]");
f=0;for(k=g.length;f<k;f++)c=g[f],c.innerHTML=this.filesize(a.size);this.options.addRemoveLinks&&(a._removeLink=b.createElement('<a class="dz-remove" href="javascript:undefined;" data-dz-remove>'+this.options.dictRemoveFile+"</a>"),a.previewElement.appendChild(a._removeLink));c=function(c){return function(f){f.preventDefault();f.stopPropagation();return a.status===b.UPLOADING?b.confirm(c.options.dictCancelUploadConfirmation,function(){return c.removeFile(a)}):c.options.dictRemoveFileConfirmation?
b.confirm(c.options.dictRemoveFileConfirmation,function(){return c.removeFile(a)}):c.removeFile(a)}}(this);l=a.previewElement.querySelectorAll("[data-dz-remove]");d=[];k=0;for(g=l.length;k<g;k++)f=l[k],d.push(f.addEventListener("click",c));return d}},removedfile:function(a){var c;a.previewElement&&null!=(c=a.previewElement)&&c.parentNode.removeChild(a.previewElement);return this._updateMaxFilesReachedClass()},thumbnail:function(a,c){var f,k,b,l;if(a.previewElement){a.previewElement.classList.remove("dz-file-preview");
l=a.previewElement.querySelectorAll("[data-dz-thumbnail]");k=0;for(b=l.length;k<b;k++)f=l[k],f.alt=a.name,f.src=c;return setTimeout(function(c){return function(){return a.previewElement.classList.add("dz-image-preview")}}(this),1)}},error:function(a,c){var f,k,b;if(a.previewElement){a.previewElement.classList.add("dz-error");"String"!==typeof c&&c.error&&(c=c.error,toastr.error(c));k=a.previewElement.querySelectorAll("[data-dz-errormessage]");b=[];f=0;for(k=k.length;f<k;f++)b.push(toastr.error(c));
return b}},errormultiple:r,processing:function(a){if(a.previewElement&&(a.previewElement.classList.add("dz-processing"),a._removeLink))return a._removeLink.textContent=this.options.dictCancelUpload},processingmultiple:r,uploadprogress:function(a,c,f){var b,g,l;if(a.previewElement){g=a.previewElement.querySelectorAll("[data-dz-uploadprogress]");l=[];f=0;for(b=g.length;f<b;f++)a=g[f],"PROGRESS"===a.nodeName?l.push(a.value=c):l.push(a.style.width=""+c+"%");return l}},totaluploadprogress:r,sending:r,
sendingmultiple:r,success:function(a){if(a.previewElement)return a.previewElement.classList.add("dz-success")},successmultiple:r,canceled:function(a){return this.emit("error",a,"Upload canceled.")},canceledmultiple:r,complete:function(a){a._removeLink&&(a._removeLink.textContent=this.options.dictRemoveFile);if(a.previewElement)return a.previewElement.classList.add("dz-complete")},completemultiple:r,maxfilesexceeded:r,maxfilesreached:r,queuecomplete:r,previewTemplate:'<div class="dz-preview dz-file-preview">\n <div class="dz-image"><img data-dz-thumbnail /></div>\n  <div class="dz-details">\n    <div class="dz-size"><span data-dz-size></span></div>\n    <div class="dz-filename"><span data-dz-name></span></div>\n  </div>\n  <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>\n  <div class="dz-success-mark">\n    <i class="icicon-check-circle-o"></i>\n  </div>\n  <div class="dz-error-mark">\n <i class="icicon-exclamation"></i>\n </div>\n <div class="dz-error-message"><span data-dz-errormessage></span></div>\n </div>'};
y=function(){var a,c,f,b,g,l,d;b=arguments[0];f=2<=arguments.length?u.call(arguments,1):[];l=0;for(d=f.length;l<d;l++)for(a in c=f[l],c)g=c[a],b[a]=g;return b};b.prototype.getAcceptedFiles=function(){var a,c,f,b,g;b=this.files;g=[];c=0;for(f=b.length;c<f;c++)a=b[c],a.accepted&&g.push(a);return g};b.prototype.getRejectedFiles=function(){var a,c,f,b,g;b=this.files;g=[];c=0;for(f=b.length;c<f;c++)a=b[c],a.accepted||g.push(a);return g};b.prototype.getFilesWithStatus=function(a){var c,f,b,g,d;g=this.files;
d=[];f=0;for(b=g.length;f<b;f++)c=g[f],c.status===a&&d.push(c);return d};b.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(b.QUEUED)};b.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(b.UPLOADING)};b.prototype.getActiveFiles=function(){var a,c,f,k,g;k=this.files;g=[];c=0;for(f=k.length;c<f;c++)a=k[c],a.status!==b.UPLOADING&&a.status!==b.QUEUED||g.push(a);return g};b.prototype.init=function(){var a,c,f,k,g,d;"form"===this.element.tagName&&this.element.setAttribute("enctype",
"multipart/form-data");this.element.classList.contains("dropzone")&&!this.element.querySelector(".dz-message")&&this.element.appendChild(b.createElement('<div class="dz-default dz-message"><span>'+this.options.dictDefaultMessage+"</span></div>"));this.clickableElements.length&&(f=function(a){return function(){a.hiddenFileInput&&document.body.removeChild(a.hiddenFileInput);a.hiddenFileInput=document.createElement("input");a.hiddenFileInput.setAttribute("type","file");(null==a.options.maxFiles||1<a.options.maxFiles)&&
a.hiddenFileInput.setAttribute("multiple","multiple");a.hiddenFileInput.className="dz-hidden-input";null!=a.options.acceptedFiles&&a.hiddenFileInput.setAttribute("accept",a.options.acceptedFiles);null!=a.options.capture&&a.hiddenFileInput.setAttribute("capture",a.options.capture);a.hiddenFileInput.style.visibility="hidden";a.hiddenFileInput.style.position="absolute";a.hiddenFileInput.style.top="0";a.hiddenFileInput.style.left="0";a.hiddenFileInput.style.height="0";a.hiddenFileInput.style.width="0";
document.body.appendChild(a.hiddenFileInput);return a.hiddenFileInput.addEventListener("change",function(){var c,b,k,d;b=a.hiddenFileInput.files;if(b.length)for(k=0,d=b.length;k<d;k++)c=b[k],a.addFile(c);return f()})}}(this),f());this.URL=null!=(a=window.URL)?a:window.webkitURL;d=this.events;k=0;for(g=d.length;k<g;k++)a=d[k],this.on(a,this.options[a]);this.on("uploadprogress",function(a){return function(){return a.updateTotalUploadProgress()}}(this));this.on("removedfile",function(a){return function(){return a.updateTotalUploadProgress()}}(this));
this.on("canceled",function(a){return function(c){return a.emit("complete",c)}}(this));this.on("complete",function(a){return function(c){if(0===a.getUploadingFiles().length&&0===a.getQueuedFiles().length)return setTimeout(function(){return a.emit("queuecomplete")},0)}}(this));c=function(a){a.stopPropagation();return a.preventDefault?a.preventDefault():a.returnValue=!1};this.listeners=[{element:this.element,events:{dragstart:function(a){return function(c){return a.emit("dragstart",c)}}(this),dragenter:function(a){return function(f){c(f);
return a.emit("dragenter",f)}}(this),dragover:function(a){return function(f){var b;try{b=f.dataTransfer.effectAllowed}catch(k){}f.dataTransfer.dropEffect="move"===b||"linkMove"===b?"move":"copy";c(f);return a.emit("dragover",f)}}(this),dragleave:function(a){return function(c){return a.emit("dragleave",c)}}(this),drop:function(a){return function(f){c(f);return a.drop(f)}}(this),dragend:function(a){return function(c){return a.emit("dragend",c)}}(this)}}];this.clickableElements.forEach(function(a){return function(c){return a.listeners.push({element:c,
events:{click:function(f){if(c!==a.element||f.target===a.element||b.elementInside(f.target,a.element.querySelector(".dz-message")))return a.hiddenFileInput.click()}}})}}(this));this.enable();return this.options.init.call(this)};b.prototype.destroy=function(){var a;this.disable();this.removeAllFiles(!0);null!=(a=this.hiddenFileInput)&&a.parentNode&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null);delete this.element.dropzone;return b.instances.splice(b.instances.indexOf(this),
1)};b.prototype.updateTotalUploadProgress=function(){var a,c,f,b,d,l;c=f=0;if(this.getActiveFiles().length){l=this.getActiveFiles();b=0;for(d=l.length;b<d;b++)a=l[b],f+=a.upload.bytesSent,c+=a.upload.total;a=100*f/c}else a=100;return this.emit("totaluploadprogress",a,c,f)};b.prototype._getParamName=function(a){return"function"===typeof this.options.paramName?this.options.paramName(a):""+this.options.paramName+(this.options.uploadMultiple?"["+a+"]":"")};b.prototype.getFallbackForm=function(){var a,
c;if(a=this.getExistingFallback())return a;a='<div class="dz-fallback">';this.options.dictFallbackText&&(a+="<p>"+this.options.dictFallbackText+"</p>");a+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>';a=b.createElement(a);"FORM"!==this.element.tagName?(c=b.createElement('<form action="'+this.options.url+'" enctype="multipart/form-data" method="'+this.options.method+'"></form>'),c.appendChild(a)):
(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method));return null!=c?c:a};b.prototype.getExistingFallback=function(){var a,c,f,b,d;c=function(a){var c,f,b;f=0;for(b=a.length;f<b;f++)if(c=a[f],/(^| )fallback($| )/.test(c.className))return c};d=["div","form"];f=0;for(b=d.length;f<b;f++)if(a=d[f],a=c(this.element.getElementsByTagName(a)))return a};b.prototype.setupEventListeners=function(){var a,c,f,b,d,l,n;l=this.listeners;n=[];b=0;for(d=
l.length;b<d;b++)a=l[b],n.push(function(){var b,k;b=a.events;k=[];for(c in b)f=b[c],k.push(a.element.addEventListener(c,f,!1));return k}());return n};b.prototype.removeEventListeners=function(){var a,c,f,b,d,l,n;l=this.listeners;n=[];b=0;for(d=l.length;b<d;b++)a=l[b],n.push(function(){var b,d;b=a.events;d=[];for(c in b)f=b[c],d.push(a.element.removeEventListener(c,f,!1));return d}());return n};b.prototype.disable=function(){var a,c,b,d,g;this.clickableElements.forEach(function(a){return a.classList.remove("dz-clickable")});
this.removeEventListeners();d=this.files;g=[];c=0;for(b=d.length;c<b;c++)a=d[c],g.push(this.cancelUpload(a));return g};b.prototype.enable=function(){this.clickableElements.forEach(function(a){return a.classList.add("dz-clickable")});return this.setupEventListeners()};b.prototype.filesize=function(a){var c,b,d,g,l,n,e,y;n=["TB","GB","MB","KB","b"];d=g=null;b=e=0;for(y=n.length;e<y;b=++e)if(l=n[b],c=Math.pow(this.options.filesizeBase,4-b)/10,a>=c){d=a/Math.pow(this.options.filesizeBase,4-b);g=l;break}d=
Math.round(10*d)/10;return"<strong>"+d+"</strong> "+g};b.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(this.getAcceptedFiles().length===this.options.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dz-max-files-reached")):this.element.classList.remove("dz-max-files-reached")};b.prototype.drop=function(a){var c;a.dataTransfer&&(this.emit("drop",a),c=a.dataTransfer.files,c.length&&
((a=a.dataTransfer.items)&&a.length&&null!=a[0].webkitGetAsEntry?this._addFilesFromItems(a):this.handleFiles(c)))};b.prototype.paste=function(a){var c;if(null!=(null!=a?null!=(c=a.clipboardData)?c.items:void 0:void 0)&&(this.emit("paste",a),a=a.clipboardData.items,a.length))return this._addFilesFromItems(a)};b.prototype.handleFiles=function(a){var c,b,d,g;g=[];b=0;for(d=a.length;b<d;b++)c=a[b],g.push(this.addFile(c));return g};b.prototype._addFilesFromItems=function(a){var c,b,d,g,l;l=[];d=0;for(g=
a.length;d<g;d++)b=a[d],null!=b.webkitGetAsEntry&&(c=b.webkitGetAsEntry())?c.isFile?l.push(this.addFile(b.getAsFile())):c.isDirectory?l.push(this._addFilesFromDirectory(c,c.name)):l.push(void 0):null!=b.getAsFile?null==b.kind||"file"===b.kind?l.push(this.addFile(b.getAsFile())):l.push(void 0):l.push(void 0);return l};b.prototype._addFilesFromDirectory=function(a,c){var b,d;b=a.createReader();d=function(a){return function(b){var f,d,k;d=0;for(k=b.length;d<k;d++)f=b[d],f.isFile?f.file(function(b){if(!a.options.ignoreHiddenFiles||
"."!==b.name.substring(0,1))return b.fullPath=""+c+"/"+b.name,a.addFile(b)}):f.isDirectory&&a._addFilesFromDirectory(f,""+c+"/"+f.name)}}(this);return b.readEntries(d,function(a){return"undefined"!==typeof console&&null!==console?"function"===typeof console.log?console.log(a):void 0:void 0})};b.prototype.accept=function(a,c){return a.size>1048576*this.options.maxFilesize?c(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(a.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.maxFilesize)):
b.isValidFile(a,this.options.acceptedFiles)?null!=this.options.maxFiles&&this.getAcceptedFiles().length>=this.options.maxFiles?(c(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.maxFiles)),this.emit("maxfilesexceeded",a)):this.options.accept.call(this,a,c):c(this.options.dictInvalidFileType)};b.prototype.addFile=function(a){a.upload={progress:0,total:a.size,bytesSent:0};this.files.push(a);a.status=b.ADDED;this.emit("addedfile",a);this._enqueueThumbnail(a);return this.accept(a,
function(c){return function(b){b?(a.accepted=!1,c._errorProcessing([a],b)):(a.accepted=!0,c.options.autoQueue&&c.enqueueFile(a));return c._updateMaxFilesReachedClass()}}(this))};b.prototype.enqueueFiles=function(a){var c,b,d;b=0;for(d=a.length;b<d;b++)c=a[b],this.enqueueFile(c);return null};b.prototype.enqueueFile=function(a){if(a.status===b.ADDED&&!0===a.accepted){if(a.status=b.QUEUED,this.options.autoProcessQueue)return setTimeout(function(a){return function(){return a.processQueue()}}(this),0)}else throw Error("This file can't be queued because it has already been processed or was rejected.");
};b.prototype._thumbnailQueue=[];b.prototype._processingThumbnail=!1;b.prototype._enqueueThumbnail=function(a){if(this.options.createImageThumbnails&&a.type.match(/image.*/)&&a.size<=1048576*this.options.maxThumbnailFilesize)return this._thumbnailQueue.push(a),setTimeout(function(a){return function(){return a._processThumbnailQueue()}}(this),0)};b.prototype._processThumbnailQueue=function(){if(!this._processingThumbnail&&0!==this._thumbnailQueue.length)return this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),
function(a){return function(){a._processingThumbnail=!1;return a._processThumbnailQueue()}}(this))};b.prototype.removeFile=function(a){a.status===b.UPLOADING&&this.cancelUpload(a);this.files=F(this.files,a);this.emit("removedfile",a);if(0===this.files.length)return this.emit("reset")};b.prototype.removeAllFiles=function(a){var c,f,d,g;null==a&&(a=!1);g=this.files.slice();f=0;for(d=g.length;f<d;f++)c=g[f],(c.status!==b.UPLOADING||a)&&this.removeFile(c);return null};b.prototype.createThumbnail=function(a,
c){var b;b=new FileReader;b.onload=function(d){return function(){if("image/svg+xml"===a.type)d.emit("thumbnail",a,b.result),null!=c&&c();else return d.createThumbnailFromUrl(a,b.result,c)}}(this);return b.readAsDataURL(a)};b.prototype.createThumbnailFromUrl=function(a,c,b){var d;d=document.createElement("img");d.onload=function(c){return function(){var l,n,e,y,m,r,x;a.width=d.width;a.height=d.height;e=c.options.resize.call(c,a);null==e.trgWidth&&(e.trgWidth=e.optWidth);null==e.trgHeight&&(e.trgHeight=
e.optHeight);l=document.createElement("canvas");n=l.getContext("2d");l.width=e.trgWidth;l.height=e.trgHeight;C(n,d,null!=(y=e.srcX)?y:0,null!=(m=e.srcY)?m:0,e.srcWidth,e.srcHeight,null!=(r=e.trgX)?r:0,null!=(x=e.trgY)?x:0,e.trgWidth,e.trgHeight);l=l.toDataURL("image/png");c.emit("thumbnail",a,l);if(null!=b)return b()}}(this);null!=b&&(d.onerror=b);return d.src=c};b.prototype.processQueue=function(){var a,c,b,d;c=this.options.parallelUploads;a=b=this.getUploadingFiles().length;if(!(b>=c)&&(d=this.getQueuedFiles(),
0<d.length)){if(this.options.uploadMultiple)return this.processFiles(d.slice(0,c-b));for(;a<c&&d.length;)this.processFile(d.shift()),a++}};b.prototype.processFile=function(a){return this.processFiles([a])};b.prototype.processFiles=function(a){var c,d,k;d=0;for(k=a.length;d<k;d++)c=a[d],c.processing=!0,c.status=b.UPLOADING,this.emit("processing",c);this.options.uploadMultiple&&this.emit("processingmultiple",a);return this.uploadFiles(a)};b.prototype._getFilesWithXhr=function(a){var c,b,d,g,l;g=this.files;
l=[];b=0;for(d=g.length;b<d;b++)c=g[b],c.xhr===a&&l.push(c);return l};b.prototype.cancelUpload=function(a){var c,d,k,g;if(a.status===b.UPLOADING){d=this._getFilesWithXhr(a.xhr);k=0;for(g=d.length;k<g;k++)c=d[k],c.status=b.CANCELED;a.xhr.abort();a=0;for(k=d.length;a<k;a++)c=d[a],this.emit("canceled",c);this.options.uploadMultiple&&this.emit("canceledmultiple",d)}else if((c=a.status)===b.ADDED||c===b.QUEUED)a.status=b.CANCELED,this.emit("canceled",a),this.options.uploadMultiple&&this.emit("canceledmultiple",
[a]);if(this.options.autoProcessQueue)return this.processQueue()};n=function(){var a,c;c=arguments[0];a=2<=arguments.length?u.call(arguments,1):[];return"function"===typeof c?c.apply(this,a):c};b.prototype.uploadFile=function(a){return this.uploadFiles([a])};b.prototype.uploadFiles=function(a){var c,d,k,g,l,e,m,r,x,u,E,D,w,C,v;w=new XMLHttpRequest;l=0;for(D=a.length;l<D;l++)c=a[l],c.xhr=w;l=n(this.options.method,a);D=n(this.options.url,a);w.open(l,D,!0);w.withCredentials=!!this.options.withCredentials;
u=null;k=function(h){return function(){var q,t,b;b=[];q=0;for(t=a.length;q<t;q++)c=a[q],b.push(h._errorProcessing(a,u||h.options.dictResponseError.replace("{{statusCode}}",w.status),w));return b}}(this);E=function(h){return function(q){var b,d,p;if(null!=q)for(b=100*q.loaded/q.total,d=0,p=a.length;d<p;d++)c=a[d],c.upload={progress:b,total:q.total,bytesSent:q.loaded};else{q=!0;b=100;d=0;for(p=a.length;d<p;d++){c=a[d];if(100!==c.upload.progress||c.upload.bytesSent!==c.upload.total)q=!1;c.upload.progress=
b;c.upload.bytesSent=c.upload.total}if(q)return}p=[];q=0;for(d=a.length;q<d;q++)c=a[q],p.push(h.emit("uploadprogress",c,b,c.upload.bytesSent));return p}}(this);w.onload=function(h){return function(q){var c;if(a[0].status!==b.CANCELED&&4===w.readyState){u=w.responseText;if(w.getResponseHeader("content-type")&&~w.getResponseHeader("content-type").indexOf("application/json"))try{u=JSON.parse(u)}catch(d){q=d,u="Invalid JSON response from server."}E();return 200<=(c=w.status)&&300>c?h._finished(a,u,q):
k()}}}(this);w.onerror=function(h){return function(){if(a[0].status!==b.CANCELED)return k()}}(this);(null!=(g=w.upload)?g:w).onprogress=E;l={Accept:"application/json","Cache-Control":"no-cache","X-Requested-With":"XMLHttpRequest"};this.options.headers&&y(l,this.options.headers);for(d in l)g=l[d],w.setRequestHeader(d,g);d=new FormData;if(this.options.params)for(r in l=this.options.params,l)g=l[r],d.append(r,g);r=0;for(g=a.length;r<g;r++)c=a[r],this.emit("sending",c,w,d);this.options.uploadMultiple&&
this.emit("sendingmultiple",a,w,d);if("FORM"===this.element.tagName)for(D=this.element.querySelectorAll("input, textarea, select, button"),g=0,l=D.length;g<l;g++)if(m=D[g],r=m.getAttribute("name"),x=m.getAttribute("type"),"SELECT"===m.tagName&&m.hasAttribute("multiple"))for(v=m.options,x=0,C=v.length;x<C;x++)m=v[x],m.selected&&d.append(r,m.value);else(!x||"checkbox"!==(e=x.toLowerCase())&&"radio"!==e||m.checked)&&d.append(r,m.value);e=r=0;for(g=a.length-1;0<=g?r<=g:r>=g;e=0<=g?++r:--r)d.append(this._getParamName(e),
a[e],a[e].name);return w.send(d)};b.prototype._finished=function(a,c,d){var k,g,l;g=0;for(l=a.length;g<l;g++)k=a[g],k.status=b.SUCCESS,this.emit("success",k,c,d),this.emit("complete",k);this.options.uploadMultiple&&(this.emit("successmultiple",a,c,d),this.emit("completemultiple",a));if(this.options.autoProcessQueue)return this.processQueue()};b.prototype._errorProcessing=function(a,c,d){var k,g,l;g=0;for(l=a.length;g<l;g++)k=a[g],k.status=b.ERROR,this.emit("error",k,c,d),this.emit("complete",k);this.options.uploadMultiple&&
(this.emit("errormultiple",a,c,d),this.emit("completemultiple",a));if(this.options.autoProcessQueue)return this.processQueue()};return b}(e);m.version="4.0.1";m.options={};m.optionsForElement=function(d){if(d.getAttribute("id"))return m.options[A(d.getAttribute("id"))]};m.instances=[];m.forElement=function(d){"string"===typeof d&&(d=document.querySelector(d));if(null==(null!=d?d.dropzone:void 0))throw Error("No Dropzone found for given element. This is probably because you're trying to access it before Dropzone had the time to initialize. Use the `init` option to setup any additional observers on your Dropzone.");
return d.dropzone};m.autoDiscover=!0;m.discover=function(){var d,b,e,n,a;document.querySelectorAll?b=document.querySelectorAll(".dropzone"):(b=[],d=function(a){var d,k,g,l;l=[];k=0;for(g=a.length;k<g;k++)d=a[k],/(^| )dropzone($| )/.test(d.className)?l.push(b.push(d)):l.push(void 0);return l},d(document.getElementsByTagName("div")),d(document.getElementsByTagName("form")));a=[];e=0;for(n=b.length;e<n;e++)d=b[e],!1!==m.optionsForElement(d)?a.push(new m(d)):a.push(void 0);return a};m.blacklistedBrowsers=
[/opera.*Macintosh.*version\/12/i];m.isBrowserSupported=function(){var d,b,e,n,a;d=!0;if(window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector)if("classList"in document.createElement("a"))for(a=m.blacklistedBrowsers,e=0,n=a.length;e<n;e++)b=a[e],b.test(navigator.userAgent)&&(d=!1);else d=!1;else d=!1;return d};F=function(d,b){var e,n,a,c;c=[];n=0;for(a=d.length;n<a;n++)e=d[n],e!==b&&c.push(e);return c};A=function(d){return d.replace(/[\-_](\w)/g,function(b){return b.charAt(1).toUpperCase()})};
m.createElement=function(d){var b;b=document.createElement("div");b.innerHTML=d;return b.childNodes[0]};m.elementInside=function(d,b){if(d===b)return!0;for(;d=d.parentNode;)if(d===b)return!0;return!1};m.getElement=function(d,b){var e;"string"===typeof d?e=document.querySelector(d):null!=d.nodeType&&(e=d);if(null==e)throw Error("Invalid `"+b+"` option provided. Please provide a CSS selector or a plain HTML element.");return e};m.getElements=function(d,b){var e,n,a,c,f;if(d instanceof Array){n=[];try{for(a=
0,c=d.length;a<c;a++)e=d[a],n.push(this.getElement(e,b))}catch(k){n=null}}else if("string"===typeof d)for(n=[],f=document.querySelectorAll(d),a=0,c=f.length;a<c;a++)e=f[a],n.push(e);else null!=d.nodeType&&(n=[d]);if(null==n||!n.length)throw Error("Invalid `"+b+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return n};m.confirm=function(d,b,e){if(window.confirm(d))return b();if(null!=e)return e()};m.isValidFile=function(d,b){var e,n,a,c,f;if(!b)return!0;
b=b.split(",");n=d.type;e=n.replace(/\/.*$/,"");c=0;for(f=b.length;c<f;c++)if(a=b[c],a=a.trim(),"."===a.charAt(0)){if(-1!==d.name.toLowerCase().indexOf(a.toLowerCase(),d.name.length-a.length))return!0}else if(/\/\*$/.test(a)){if(e===a.replace(/\/.*$/,""))return!0}else if(n===a)return!0;return!1};"undefined"!==typeof tQuery&&null!==tQuery&&(tQuery.fn.dropzone=function(d){return this.each(function(){return new m(this,d)})});"undefined"!==typeof module&&null!==module?module.exports=m:window.Dropzone=
m;m.ADDED="added";m.QUEUED="queued";m.ACCEPTED=m.QUEUED;m.UPLOADING="uploading";m.PROCESSING=m.UPLOADING;m.CANCELED="canceled";m.ERROR="error";m.SUCCESS="success";J=function(d){var b,e,n,a,c;n=d.naturalHeight;b=document.createElement("canvas");b.width=1;b.height=n;b=b.getContext("2d");b.drawImage(d,0,0);b=b.getImageData(0,0,1,n).data;c=0;for(a=e=n;a>c;)d=b[4*(a-1)+3],0===d?e=a:c=a,a=e+c>>1;n=a/n;return 0===n?1:n};C=function(d,b,e,n,a,c,f,k,g,l){var m;m=J(b);return d.drawImage(b,e,n,a,c,f,k,g,l/m)};
m._autoDiscoverFunction=function(){if(m.autoDiscover)return m.discover()};(function(d,b){var e,n,a,c,f,k,g,l,m;a=!1;m=!0;n=d.document;l=n.documentElement;e=n.addEventListener?"addEventListener":"attachEvent";g=n.addEventListener?"removeEventListener":"detachEvent";k=n.addEventListener?"":"on";c=function(f){if("readystatechange"!==f.type||"complete"===n.readyState)if(("load"===f.type?d:n)[g](k+f.type,c,!1),!a&&(a=!0))return b.call(d,f.type||f)};f=function(){try{l.doScroll("left")}catch(a){setTimeout(f,
50);return}return c("poll")};if("complete"!==n.readyState){if(n.createEventObject&&l.doScroll){try{m=!d.frameElement}catch(r){}m&&f()}n[e](k+"DOMContentLoaded",c,!1);n[e](k+"readystatechange",c,!1);return d[e](k+"load",c,!1)}})(window,m._autoDiscoverFunction)}).call(this);
(function(){function m(h){return function(q,b,d,p){b=c(b,p,4);var f=!l(q)&&a.keys(q),e=(f||q).length,g=0<h?0:e-1;3>arguments.length&&(d=q[f?f[g]:g],g+=h);for(var k=b,n=d;0<=g&&e>g;g+=h)var m=f?f[g]:g,n=k(n,q[m],m,q);return n}}function e(a){return function(q,b,c){b=f(b,c);c=null!=q&&q.length;for(var d=0<a?0:c-1;0<=d&&c>d;d+=a)if(b(q[d],d,q))return d;return-1}}var A=this,J=A._,C=Array.prototype,r=Object.prototype,F=C.push,u=C.slice,x=r.toString,E=r.hasOwnProperty,r=Array.isArray,d=Object.keys,b=Function.prototype.bind,
y=Object.create,n=function(){},a=function(h){return h instanceof a?h:this instanceof a?void(this._wrapped=h):new a(h)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=a),exports._=a):A._=a;a.VERSION="1.8.1";var c=function(a,q,b){if(void 0===q)return a;switch(null==b?3:b){case 1:return function(b){return a.call(q,b)};case 2:return function(b,c){return a.call(q,b,c)};case 3:return function(b,c,t){return a.call(q,b,c,t)};case 4:return function(b,c,t,d){return a.call(q,
b,c,t,d)}}return function(){return a.apply(q,arguments)}},f=function(h,q,b){return null==h?a.identity:a.isFunction(h)?c(h,q,b):a.isObject(h)?a.matcher(h):a.property(h)};a.iteratee=function(a,q){return f(a,q,1/0)};var k=function(a,q){return function(b){var c=arguments.length;if(2>c||null==b)return b;for(var d=1;c>d;d++)for(var f=arguments[d],e=a(f),g=e.length,k=0;g>k;k++){var l=e[k];q&&void 0!==b[l]||(b[l]=f[l])}return b}},g=Math.pow(2,53)-1,l=function(a){a=a&&a.length;return"number"==typeof a&&0<=
a&&g>=a};a.each=a.forEach=function(h,q,b){q=c(q,b);var d;if(l(h))for(b=0,d=h.length;d>b;b++)q(h[b],b,h);else{var p=a.keys(h);b=0;for(d=p.length;d>b;b++)q(h[p[b]],p[b],h)}return h};a.map=a.collect=function(h,q,b){q=f(q,b);b=!l(h)&&a.keys(h);for(var c=(b||h).length,d=Array(c),e=0;c>e;e++){var g=b?b[e]:e;d[e]=q(h[g],g,h)}return d};a.reduce=a.foldl=a.inject=m(1);a.reduceRight=a.foldr=m(-1);a.find=a.detect=function(h,b,c){var d;return d=l(h)?a.findIndex(h,b,c):a.findKey(h,b,c),void 0!==d&&-1!==d?h[d]:
void 0};a.filter=a.select=function(h,b,c){var d=[];return b=f(b,c),a.each(h,function(a,h,c){b(a,h,c)&&d.push(a)}),d};a.reject=function(h,b,c){return a.filter(h,a.negate(f(b)),c)};a.every=a.all=function(h,b,c){b=f(b,c);c=!l(h)&&a.keys(h);for(var d=(c||h).length,p=0;d>p;p++){var e=c?c[p]:p;if(!b(h[e],e,h))return!1}return!0};a.some=a.any=function(h,b,c){b=f(b,c);c=!l(h)&&a.keys(h);for(var d=(c||h).length,p=0;d>p;p++){var e=c?c[p]:p;if(b(h[e],e,h))return!0}return!1};a.contains=a.includes=a.include=function(h,
b){return l(h)||(h=a.values(h)),0<=a.indexOf(h,b)};a.invoke=function(h,b){var c=u.call(arguments,2),d=a.isFunction(b);return a.map(h,function(a){var h=d?b:a[b];return null==h?h:h.apply(a,c)})};a.pluck=function(h,b){return a.map(h,a.property(b))};a.where=function(h,b){return a.filter(h,a.matcher(b))};a.findWhere=function(h,b){return a.find(h,a.matcher(b))};a.max=function(h,b,c){var d,p=-1/0,e=-1/0;if(null==b&&null!=h){h=l(h)?h:a.values(h);for(var g=0,k=h.length;k>g;g++)c=h[g],c>p&&(p=c)}else b=f(b,
c),a.each(h,function(a,h,c){d=b(a,h,c);(d>e||d===-1/0&&p===-1/0)&&(p=a,e=d)});return p};a.min=function(h,b,c){var d,p=1/0,e=1/0;if(null==b&&null!=h){h=l(h)?h:a.values(h);for(var g=0,k=h.length;k>g;g++)c=h[g],p>c&&(p=c)}else b=f(b,c),a.each(h,function(a,h,c){d=b(a,h,c);(e>d||1/0===d&&1/0===p)&&(p=a,e=d)});return p};a.shuffle=function(h){for(var b=l(h)?h:a.values(h),c=b.length,d=Array(c),p=0;c>p;p++)h=a.random(0,p),h!==p&&(d[p]=d[h]),d[h]=b[p];return d};a.sample=function(h,b,c){return null==b||c?(l(h)||
(h=a.values(h)),h[a.random(h.length-1)]):a.shuffle(h).slice(0,Math.max(0,b))};a.sortBy=function(h,b,c){return b=f(b,c),a.pluck(a.map(h,function(a,h,c){return{value:a,index:h,criteria:b(a,h,c)}}).sort(function(a,h){var b=a.criteria,c=h.criteria;if(b!==c){if(b>c||void 0===b)return 1;if(c>b||void 0===c)return-1}return a.index-h.index}),"value")};var G=function(h){return function(b,c,d){var p={};return c=f(c,d),a.each(b,function(a,d){var f=c(a,d,b);h(p,a,f)}),p}};a.groupBy=G(function(h,b,c){a.has(h,c)?
h[c].push(b):h[c]=[b]});a.indexBy=G(function(a,b,c){a[c]=b});a.countBy=G(function(h,b,c){a.has(h,c)?h[c]++:h[c]=1});a.toArray=function(h){return h?a.isArray(h)?u.call(h):l(h)?a.map(h,a.identity):a.values(h):[]};a.size=function(h){return null==h?0:l(h)?h.length:a.keys(h).length};a.partition=function(h,b,c){b=f(b,c);var d=[],p=[];return a.each(h,function(a,h,c){(b(a,h,c)?d:p).push(a)}),[d,p]};a.first=a.head=a.take=function(h,b,c){return null==h?void 0:null==b||c?h[0]:a.initial(h,h.length-b)};a.initial=
function(a,b,c){return u.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))};a.last=function(h,b,c){return null==h?void 0:null==b||c?h[h.length-1]:a.rest(h,Math.max(0,h.length-b))};a.rest=a.tail=a.drop=function(a,b,c){return u.call(a,null==b||c?1:b)};a.compact=function(h){return a.filter(h,a.identity)};var H=function(h,b,c,d){var f=[],e=0;d=d||0;for(var g=h&&h.length;g>d;d++){var k=h[d];if(l(k)&&(a.isArray(k)||a.isArguments(k))){b||(k=H(k,b,c));var n=0,m=k.length;for(f.length+=m;m>n;)f[e++]=k[n++]}else c||
(f[e++]=k)}return f};a.flatten=function(a,b){return H(a,b,!1)};a.without=function(h){return a.difference(h,u.call(arguments,1))};a.uniq=a.unique=function(h,b,c,d){if(null==h)return[];a.isBoolean(b)||(d=c,c=b,b=!1);null!=c&&(c=f(c,d));d=[];for(var p=[],e=0,g=h.length;g>e;e++){var k=h[e],l=c?c(k,e,h):k;b?(e&&p===l||d.push(k),p=l):c?a.contains(p,l)||(p.push(l),d.push(k)):a.contains(d,k)||d.push(k)}return d};a.union=function(){return a.uniq(H(arguments,!0,!0))};a.intersection=function(h){if(null==h)return[];
for(var b=[],c=arguments.length,d=0,f=h.length;f>d;d++){var e=h[d];if(!a.contains(b,e)){for(var g=1;c>g&&a.contains(arguments[g],e);g++);g===c&&b.push(e)}}return b};a.difference=function(b){var c=H(arguments,!0,!0,1);return a.filter(b,function(b){return!a.contains(c,b)})};a.zip=function(){return a.unzip(arguments)};a.unzip=function(b){for(var c=b&&a.max(b,"length").length||0,d=Array(c),f=0;c>f;f++)d[f]=a.pluck(b,f);return d};a.object=function(a,b){for(var c={},d=0,f=a&&a.length;f>d;d++)b?c[a[d]]=
b[d]:c[a[d][0]]=a[d][1];return c};a.indexOf=function(b,c,d){var f=0,e=b&&b.length;if("number"==typeof d)f=0>d?Math.max(0,e+d):d;else if(d&&e)return f=a.sortedIndex(b,c),b[f]===c?f:-1;if(c!==c)return a.findIndex(u.call(b,f),a.isNaN);for(;e>f;f++)if(b[f]===c)return f;return-1};a.lastIndexOf=function(b,c,d){var f=b?b.length:0;if("number"==typeof d&&(f=0>d?f+d+1:Math.min(f,d+1)),c!==c)return a.findLastIndex(u.call(b,0,f),a.isNaN);for(;0<=--f;)if(b[f]===c)return f;return-1};a.findIndex=e(1);a.findLastIndex=
e(-1);a.sortedIndex=function(a,b,c,d){c=f(c,d,1);b=c(b);d=0;for(var e=a.length;e>d;){var g=Math.floor((d+e)/2);c(a[g])<b?d=g+1:e=g}return d};a.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);c=c||1;for(var d=Math.max(Math.ceil((b-a)/c),0),f=Array(d),e=0;d>e;e++,a+=c)f[e]=a;return f};var T=function(b,c,d,f,e){if(!(f instanceof c))return b.apply(d,e);c=b.prototype;a.isObject(c)?y?c=y(c):(n.prototype=c,c=new n,c=(n.prototype=null,c)):c={};b=b.apply(c,e);return a.isObject(b)?b:c};a.bind=function(c,
d){if(b&&c.bind===b)return b.apply(c,u.call(arguments,1));if(!a.isFunction(c))throw new TypeError("Bind must be called on a function");var f=u.call(arguments,2),e=function(){return T(c,e,d,this,f.concat(u.call(arguments)))};return e};a.partial=function(b){var c=u.call(arguments,1),d=function(){for(var f=0,e=c.length,g=Array(e),k=0;e>k;k++)g[k]=c[k]===a?arguments[f++]:c[k];for(;f<arguments.length;)g.push(arguments[f++]);return T(b,d,this,this,g)};return d};a.bindAll=function(b){var c,d,f=arguments.length;
if(1>=f)throw Error("bindAll must be passed function names");for(c=1;f>c;c++)d=arguments[c],b[d]=a.bind(b[d],b);return b};a.memoize=function(b,c){var d=function(f){var e=d.cache,g=""+(c?c.apply(this,arguments):f);return a.has(e,g)||(e[g]=b.apply(this,arguments)),e[g]};return d.cache={},d};a.delay=function(a,b){var c=u.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};a.defer=a.partial(a.delay,a,1);a.throttle=function(b,c,d){var f,e,g,k=null,l=0;d||(d={});var n=function(){l=
!1===d.leading?0:a.now();k=null;g=b.apply(f,e);k||(f=e=null)};return function(){var m=a.now();l||!1!==d.leading||(l=m);var r=c-(m-l);return f=this,e=arguments,0>=r||r>c?(k&&(clearTimeout(k),k=null),l=m,g=b.apply(f,e),k||(f=e=null)):k||!1===d.trailing||(k=setTimeout(n,r)),g}};a.debounce=function(b,c,d){var f,e,g,k,l,n=function(){var m=a.now()-k;c>m&&0<=m?f=setTimeout(n,c-m):(f=null,d||(l=b.apply(g,e),f||(g=e=null)))};return function(){g=this;e=arguments;k=a.now();var m=d&&!f;return f||(f=setTimeout(n,
c)),m&&(l=b.apply(g,e),g=e=null),l}};a.wrap=function(b,c){return a.partial(c,b)};a.negate=function(a){return function(){return!a.apply(this,arguments)}};a.compose=function(){var a=arguments,b=a.length-1;return function(){for(var c=b,d=a[b].apply(this,arguments);c--;)d=a[c].call(this,d);return d}};a.after=function(a,b){return function(){return 1>--a?b.apply(this,arguments):void 0}};a.before=function(a,b){var c;return function(){return 0<--a&&(c=b.apply(this,arguments)),1>=a&&(b=null),c}};a.once=a.partial(a.before,
2);a.keys=function(b){if(!a.isObject(b))return[];if(d)return d(b);var c=[],f;for(f in b)a.has(b,f)&&c.push(f);return c};a.allKeys=function(b){if(!a.isObject(b))return[];var c=[],d;for(d in b)c.push(d);return c};a.values=function(b){for(var c=a.keys(b),d=c.length,f=Array(d),e=0;d>e;e++)f[e]=b[c[e]];return f};a.mapObject=function(b,c,d){c=f(c,d);for(var e=a.keys(b),g=e.length,k={},l=0;g>l;l++)d=e[l],k[d]=c(b[d],d,b);return k};a.pairs=function(b){for(var c=a.keys(b),d=c.length,f=Array(d),e=0;d>e;e++)f[e]=
[c[e],b[c[e]]];return f};a.invert=function(b){for(var c={},d=a.keys(b),f=0,e=d.length;e>f;f++)c[b[d[f]]]=d[f];return c};a.functions=a.methods=function(b){var c=[],d;for(d in b)a.isFunction(b[d])&&c.push(d);return c.sort()};a.extend=k(a.allKeys);a.extendOwn=k(a.keys);a.findKey=function(b,c,d){c=f(c,d);var e;d=a.keys(b);for(var g=0,k=d.length;k>g;g++)if(e=d[g],c(b[e],e,b))return e};a.pick=function(b,d,f){var e,g={};if(null==b)return g;if(a.isFunction(d)){d=c(d,f);for(var k=a.allKeys(b),l=0;l<k.length;l++){e=
k[l];var n=b[e];d(n,e,b)&&(g[e]=n)}}else for(k=H(arguments,!1,!1,1),b=Object(b),l=0,n=k.length;n>l;l++)e=k[l],e in b&&(g[e]=b[e]);return g};a.omit=function(b,c,d){if(a.isFunction(c))c=a.negate(c);else{var f=a.map(H(arguments,!1,!1,1),String);c=function(b,c){return!a.contains(f,c)}}return a.pick(b,c,d)};a.defaults=k(a.allKeys,!0);a.clone=function(b){return a.isObject(b)?a.isArray(b)?b.slice():a.extend({},b):b};a.tap=function(a,b){return b(a),a};a.isMatch=function(b,c){var d=a.keys(c),f=d.length;if(null==
b)return!f;for(var e=Object(b),g=0;f>g;g++){var k=d[g];if(c[k]!==e[k]||!(k in e))return!1}return!0};var M=function(b,c,d,f){if(b===c)return 0!==b||1/b===1/c;if(null==b||null==c)return b===c;b instanceof a&&(b=b._wrapped);c instanceof a&&(c=c._wrapped);var e=x.call(b);if(e!==x.call(c))return!1;switch(e){case "[object RegExp]":case "[object String]":return""+b==""+c;case "[object Number]":return+b!==+b?+c!==+c:0===+b?1/+b===1/c:+b===+c;case "[object Date]":case "[object Boolean]":return+b===+c}e="[object Array]"===
e;if(!e){if("object"!=typeof b||"object"!=typeof c)return!1;var g=b.constructor,k=c.constructor;if(g!==k&&!(a.isFunction(g)&&g instanceof g&&a.isFunction(k)&&k instanceof k)&&"constructor"in b&&"constructor"in c)return!1}d=d||[];f=f||[];for(g=d.length;g--;)if(d[g]===b)return f[g]===c;if(d.push(b),f.push(c),e){if(g=b.length,g!==c.length)return!1;for(;g--;)if(!M(b[g],c[g],d,f))return!1}else{var l,e=a.keys(b);if(g=e.length,a.keys(c).length!==g)return!1;for(;g--;)if(l=e[g],!a.has(c,l)||!M(b[l],c[l],d,
f))return!1}return d.pop(),f.pop(),!0};a.isEqual=function(a,b){return M(a,b)};a.isEmpty=function(b){return null==b?!0:l(b)&&(a.isArray(b)||a.isString(b)||a.isArguments(b))?0===b.length:0===a.keys(b).length};a.isElement=function(a){return!(!a||1!==a.nodeType)};a.isArray=r||function(a){return"[object Array]"===x.call(a)};a.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a};a.each("Arguments Function String Number Date RegExp Error".split(" "),function(b){a["is"+b]=function(a){return x.call(a)===
"[object "+b+"]"}});a.isArguments(arguments)||(a.isArguments=function(b){return a.has(b,"callee")});"function"!=typeof/./&&"object"!=typeof Int8Array&&(a.isFunction=function(a){return"function"==typeof a||!1});a.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};a.isNaN=function(b){return a.isNumber(b)&&b!==+b};a.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"===x.call(a)};a.isNull=function(a){return null===a};a.isUndefined=function(a){return void 0===a};a.has=function(a,
b){return null!=a&&E.call(a,b)};a.noConflict=function(){return A._=J,this};a.identity=function(a){return a};a.constant=function(a){return function(){return a}};a.noop=function(){};a.property=function(a){return function(b){return null==b?void 0:b[a]}};a.propertyOf=function(a){return null==a?function(){}:function(b){return a[b]}};a.matcher=a.matches=function(b){return b=a.extendOwn({},b),function(c){return a.isMatch(c,b)}};a.times=function(a,b,d){var f=Array(Math.max(0,a));b=c(b,d,1);for(d=0;a>d;d++)f[d]=
b(d);return f};a.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};a.now=Date.now||function(){return(new Date).getTime()};r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};k=a.invert(r);G=function(b){var c=function(a){return b[a]},d="(?:"+a.keys(b).join("|")+")",f=RegExp(d),e=RegExp(d,"g");return function(a){return a=null==a?"":""+a,f.test(a)?a.replace(e,c):a}};a.escape=G(r);a.unescape=G(k);a.result=function(b,c,d){c=null==b?void 0:b[c];
return void 0===c&&(c=d),a.isFunction(c)?c.call(b):c};var K=0;a.uniqueId=function(a){var b=++K+"";return a?a+b:b};a.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var I=/(.)^/,D={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},w=/\\|'|\r|\n|\u2028|\u2029/g,Q=function(a){return"\\"+D[a]};a.template=function(b,c,d){!c&&d&&(c=d);c=a.defaults({},c,a.templateSettings);d=RegExp([(c.escape||I).source,(c.interpolate||I).source,
(c.evaluate||I).source].join("|")+"|$","g");var f=0,e="__p+='";b.replace(d,function(a,c,d,g,k){return e+=b.slice(f,k).replace(w,Q),f=k+a.length,c?e+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?e+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(e+="';\n"+g+"\n__p+='"),a});e+="';\n";c.variable||(e="with(obj||{}){\n"+e+"}\n");e="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+e+"return __p;\n";try{var g=new Function(c.variable||"obj","_",e)}catch(k){throw k.source=
e,k;}d=function(b){return g.call(this,b,a)};return d.source="function("+(c.variable||"obj")+"){\n"+e+"}",d};a.chain=function(b){b=a(b);return b._chain=!0,b};var v=function(b,c){return b._chain?a(c).chain():c};a.mixin=function(b){a.each(a.functions(b),function(c){var d=a[c]=b[c];a.prototype[c]=function(){var b=[this._wrapped];return F.apply(b,arguments),v(this,d.apply(a,b))}})};a.mixin(a);a.each("pop push reverse shift sort splice unshift".split(" "),function(b){var c=C[b];a.prototype[b]=function(){var a=
this._wrapped;return c.apply(a,arguments),"shift"!==b&&"splice"!==b||0!==a.length||delete a[0],v(this,a)}});a.each(["concat","join","slice"],function(b){var c=C[b];a.prototype[b]=function(){return v(this,c.apply(this._wrapped,arguments))}});a.prototype.value=function(){return this._wrapped};a.prototype.valueOf=a.prototype.toJSON=a.prototype.value;a.prototype.toString=function(){return""+this._wrapped};"function"==typeof define&&define.amd&&define("underscore",[],function(){return a})}).call(this);
(function(m,e,A){var J={onDataRequest:m.noop,realValOnSubmit:!0,triggers:{"@":{minChars:1,uniqueTags:!1,showImageOrIcon:!0,keys_map:{id:"id",name:"name",description:"fullname",img:"img",type:"type"},syntax:e.template("@[<%= type %>:<%= id %>:<%= title %>]"),parser:/(@)\[([\w\s\.\-]+):(\d+):([\w\s@\.,-\/#!$%\^&\*;:{}=\-_`~()]+)\]/gi,parserGroups:{type:2,id:3,title:4},classes:{tagsDropDown:"ismentiondd",tagActiveDropDown:"active",tagHighlight:"ismention"}},"#":{minChars:1,uniqueTags:!1,showImageOrIcon:!1,
keys_map:{id:"id",name:"name",type:"type"},syntax:e.template("#[<%= type %>:<%= id %>:<%= title %>]"),parser:/(#)\[([\w\s\.\-]+):(\d+):([\w\s@\.,-\/#!$%\^&\*;:{}=\-_`~()]+)\]/gi,parserGroups:{type:2,id:3,title:4},classes:{tagsDropDown:"ishashtagdd",tagActiveDropDown:"active",tagHighlight:"ishashtag"}}},templates:{wrapper:e.template('<div class="textntags-wrapper"></div>'),beautifier:e.template('<div class="textntags-beautifier"><div></div></div>'),tagHighlight:e.template('<strong class="<%= class_name %>"><span>$<%= idx %></span></strong>'),
tagList:e.template('<div class="textntags-tag-list"></div>'),tagsListItem:e.template("<li><%= title %></li>"),tagsListItemImage:e.template('<img src="<%= img %>" />'),tagsListItemIcon:e.template('<div class="icon <%= no_img_class %>"></div>')}},C={minChars:2,uniqueTags:!0,showImageOrIcon:!0,keys_map:{id:"id",title:"name",description:"",img:"img",no_img_class:"icon",type:"type"},syntax:e.template("@[<%= type %>:<%= id %>:<%= title %>]"),parser:/(@)\[([\w\s\.\-]+):(\d+):([\w\s@\.,-\/#!$%\^&\*;:{}=\-_`~()]+)\]/gi,
parserGroups:{type:2,id:3,title:4},classes:{tagsDropDown:"",tagActiveDropDown:"active",tagHighlight:""}},r=e.memoize(function(m){return function(r,d){var b={};d?e.each(m,function(d,e){b[d]=r[e]}):e.each(m,function(d,e){b[e]=r[d]});return b}}),F={htmlEncode:function(m){return e.escape(m)},highlightTerm:function(e,m){return m||m.length?"<b>"+e+" <i class='icicon-arrow-circle-o-left'></i></b>":e},setCaratPosition:function(e,m){if(e.createTextRange){var d=e.createTextRange();d.move("character",m);d.select()}else e.selectionStart?
(e.focus(),e.setSelectionRange(m,m)):e.focus()}},u=function(u){function E(a){if(null!=v)return!1;v=m.extend(!0,{},J,a);delete v.triggers[""];e.each(v.triggers,function(a,b){v.triggers[b]=m.extend(!0,{},C,a);v.triggers[b].finder=new RegExp(b+"\\w+(\\s+\\w+)?\\s?$","gi")});h=v.templates;return!0}function d(){t=m(u).bind({click:k,keydown:g,keypress:l,input:G,blur:H});q=t.wrapAll(m(h.wrapper())).parent();v.realValOnSubmit&&t.closest("form").bind("submit.textntags",function(a){q.css("visibility","hidden");
t.val(n())})}function b(){var b=t.val(),b=a(b);z=b.tagsCollection;t.val(b.plain_text);c();0<z.length&&(b=e.uniq(e.map(z,function(a){return a[3]})),t.trigger("tagsAdded.textntags",[b]))}function y(a){var b=a||n();e.each(v.triggers,function(a){var c=h.tagHighlight({idx:a.parserGroups.title,class_name:a.classes.tagHighlight});b=b.replace(a.parser,c)});b=b.replace(/\n/g,"<br />&shy;");return b=b.replace(/ {2}/g,"&nbsp; ")+"&shy;"}function n(){var a=t.val(),b=0,c=v.triggers;return e.map(z,function(d){var e=
d[0]-b,e=0<e?a.substr(b,e):"",f=r(c[d[2]].keys_map),f=c[d[2]].syntax(f(d[3],!1));b=d[0]+d[1];return e+f}).join("")+a.substr(b)}function a(a){if(0==e.isString(a))return null;var b=""+a,c=[],d=v.triggers;e.each(d,function(b,d){for(var f=a.split(b.parser),g=0,h=0,k=f.length,l,m,n,p=e.max(b.parserGroups);g<k;)f[g]==d?(l={},e.each(b.parserGroups,function(a,c){l[b.keys_map[c]]=f[g+a-1];"title"==c&&(m=f[g+a-1].length)}),c.push([h,m,d,l]),n=m,g+=p):(n=f[g].length,g+=1),h+=n});c=e.sortBy(c,function(a){return a[0]});
e.each(d,function(a,c){b=b.replace(a.parser,"$"+a.parserGroups.title)});return{plain_text:b,tagged_text:a,tagsCollection:c}}function c(a){N.find("div").html(y());t.css("height",N.outerHeight()+"px")}function f(a){a=a||0;var b=t[0].selectionStart,c=t.val().substr(0,b+a),d=null,f;c&&c.length&&(a=e.find(v.triggers,function(a,b){var e=c.match(a.finder);return e?(d=b,f=e[0].substr(b.length),!0):!1}),!d||f.length<a.minChars?A():(O=f,L=d,e.defer(e.bind(Q,this,O,d))))}function k(a){f(0)}function g(a){var b=
t[0].selectionStart,c=t[0].selectionEnd,d=t.val();R=c-b;U=d.length;P=a.keyCode;switch(a.keyCode){case 38:case 40:if(!p.is(":visible"))break;b=null;b=40==a.keyCode?B&&B.length?B.next():p.find("li").first():B&&B.length?B.prev():p.find("li").last();D(b,v.triggers[L].classes.tagActiveDropDown);return!1;case 13:case 9:if(B&&B.length)return S=!0,B.click(),!1;break;case 8:case 46:8==a.keyCode&&b==c&&0<b&&--b;c>b&&(K(b,c),I(c,b-c));break;case 37:case 39:case 36:case 35:e.defer(function(){f.call(this,0)})}return!0}
function l(a){13==a.keyCode&&c(t.val());S&&(13!=a.keyCode&&9!=a.keyCode||a.preventDefault(),S=!1)}function G(a){if(8!=P&&46!=P)if(0<R){a=t[0].selectionStart;var b=a+R,d=t.val().length-U;K(a,b);I(b,d)}else a=t[0].selectionStart,13==P?(I(a-1,1),K(a,a)):(I(a,1),K(a,a+1));c();f(1)}function H(a){e.delay(A,100)}function A(){B=null;p.hide().empty()}function M(a){a=m(this).data("tag");var b=v.triggers[L],d=r(b.keys_map)(a,!1),e=t.val(),f=t[0].selectionStart,g=f-L.length-O.length,h=g+d.title.length,k=e.substr(0,
g),e=e.substr(f),k=k+d.title+e;a[b.keys_map.id]=""+a[b.keys_map.id];z.push([g,d.title.length,L,a]);O=L="";A();t.val(k);c();t.focus();F.setCaratPosition(t[0],h);t.trigger("tagsAdded.textntags",[[a]]);return!1}function K(a,b){var c=[];z=e.filter(z,function(d){var e=d[0],f=e+d[1];(e=e>=a&&e<b||f>a&&f<=b||e<a&&f>b)&&c.push(d[3]);return!e});0<c.length&&t.trigger("tagsRemoved.textntags",[c])}function I(a,b){z=e.map(z,function(c){c[0]>=a&&(c[0]+=b);return c})}function D(a,b){a&&a.length?(a.addClass(b),a.siblings().removeClass(b),
B=a):(B.removeClass(b),B=null)}function w(a,b,c){var d=v.triggers[b];if(d.uniqueTags){var f=d.keys_map.id,g=e.map(z,function(a){return a[3][f]});c=e.reject(c,function(a){return e.include(g,""+a[f])})}if(c.length){var k=m("<ul />").addClass(d.classes.tagsDropDown).appendTo(p),l=d.showImageOrIcon?h.tagsListItemImage:h.tagsListItemIcon,n=r(d.keys_map);e.each(c,function(b,c){var e,f=n(b,!1);f.title=F.highlightTerm(F.htmlEncode(f.title),a);e=m(h.tagsListItem(f)).data("tag",b);e=e.prepend(l(f)).appendTo(k);
0===c&&D(e,d.classes.tagActiveDropDown)});p.show()}}function Q(a,b){A();v.onDataRequest.call(this,"search",a,b,function(c){w(a,b,c)})}var v=null,h,q,t,N,p,B,z,L,O,R=0,U=0,P=0,S=!1;return{init:function(a){E(a)&&(d(),p=m(h.tagList()),p.appendTo(q),p.delegate("li","click",M),N=m(h.beautifier()),N.prependTo(q),b())},val:function(a){if(e.isString(a)){var c=e.uniq(e.map(z,function(a){return a[3]}));t.trigger("tagsRemoved.textntags",[c]);t.val(a);b()}else e.isFunction(a)&&(c=z.length?n():t.val(),a.call(this,
c))},reset:function(){var a=e.uniq(e.map(z,function(a){return a[3]}));t.trigger("tagsRemoved.textntags",[a]);t.val("");z=[];c()},getTags:function(a){if(e.isFunction(a)){var b=e.map(z,function(a){return a[3]});a.call(this,e.uniq(b))}},getTagsMap:function(a){e.isFunction(a)&&a.call(this,z)},getTagsMapFacebook:function(a){if(e.isFunction(a)){var b={},c=v.triggers;e.each(z,function(a){var d=r(c[a[2]].keys_map)(a[3],!1);b[a[0]]=[{id:d.id,name:d.title,type:d.type,offset:a[0],length:a[1]}]});a.call(this,
b)}},getPlainText:function(b){e.isFunction(b)&&b.call(this,a(n()).plain_text)},parseTaggedText:function(b,c){e.isFunction(c)&&c.call(this,a(b))}}};m.fn.textntags=function(r){var A=arguments;return this.each(function(){var d=r,b=m.data(this,"textntags")||m.data(this,"textntags",new u(this));if(e.isFunction(b[d]))return b[d].apply(this,Array.prototype.slice.call(A,1));if("object"!==typeof d&&d)m.error("Method "+d+" does not exist");else return b.init.call(this,d)})}})(tQuery,_);